#+hugo_base_dir: ../
#+hugo_section: posts
#+hugo_weight: auto
#+startup: logdone
#+macro: imgzoom #+attr_html: :link t

* Posts
** DONE Games I Want To Run :@rpg:
Closed: [2025-01-28 Tue 17:10]
:PROPERTIES:
:EXPORT_FILE_NAME: games_to_run
:END:
#+TOC: headlines 1
*** [[https://shop.arcdream.com/products/delta-green-the-role-playing-game-hardback-slipcase-set?ref=delta-green.com][Delta Green]]
{{{imgzoom}}}
[[/blog/images/delta_green.png]]

#+begin_quote
As you wind down the dark roads from the log cabin you take stock of your team. Agent Reynolds is bleeding from a deep gash across his stomach that smells worse than could be good but, you think he will make it.
Reinhardt is in the back muttering "She was dead, she was dead, she was dead" over and over and over. Rogers somehow seems to be doing the best despite the thick blood caked across his face. You check in with your FBI handler and let them know it was a false alarm, nothing to see here.
#+end_quote

The world is ending and right before calamity the good guys sweep in and save the day. You are those good guys but what does it cost your sanity to see the things you have seen.

Based on Call Of Cthulhu but modern era. Easy to play and lots of cool character building systems. You should hopefully save the world but maybe not make it out alive.

Related Media:
- X-Files
- Stranger Things
- True Detective
*** [[https://www.tuesdayknightgames.com/pages/mothership-rpg][Mothership]]
{{{imgzoom}}}
[[/blog/images/mothership.jpg]]

#+begin_quote
The airlock door opens with a faint hiss and a worrying clunk, if you make it back alive and in one piece you should probably get that looked at. You round the corner and the lights flicker on and off in quick rapid bursts. The screams let you know what to expect as the limbs and torsos of what once the rest of your crew round the corner in front of you. 
#+end_quote

A crew tries (and often fails) to survive the vast expansive of space and all of the human and inhuman horrors it contains.

Simple system with very little to learn to pickup and play. But your character is very unlikely to change much and will almost certainly be dead.

Related Media:
- Alien franchise
- Underwater
- Event Horizon
*** [[https://www.thearcanelibrary.com/pages/shadowdark][Shadowdark]]
{{{imgzoom}}}
[[/blog/images/shadowdark.avif]]

#+begin_quote
The torch light in front of you barely illuminates a set of glowing runes on the floor on the chamber. Your fingers trace the grooves as your try and recall your days in the academy. It dawns on you that these are necromancy just as your final torch begins to sputter in your hands.  
#+end_quote

A much more streamlined dungeon crawling adventure. Use magic, steel, and wits to delve into mysterious ruins, lost cities, and monster-infested depths. Wondrous treasures and long-forgotten secrets await you! But don't let your last torch burn out, or you could be swallowed by the Shadowdark.

Related Media:
- Lord of the Rings
- Conan
- The 13th Warrior
*** [[https://www.kickstarter.com/projects/bastionland/mythic-bastionland-rpg-before-into-the-odd][Mythic Bastionland]]
{{{imgzoom}}}
[[/blog/images/mythic_bastionland.jpg]]
Rules light roleplaying in a dreamlike world of knights and myths. Crawl hexes, rule a domain, and remember your oath.

Very Arthurian Knights roaming a kingdom, completing quests and meeting weird seers.

Related Media:
- The Green Knight
*** [[https://www.myth.works/en-gb/pages/slugblaster][Slugblaster]]
{{{imgzoom}}}
[[file:/blog/images/slugblaster.webp][file:/blog/images/slugblaster.webp]]

In the small town of Hillview, teenage hoverboarders sneak into other dimensions to explore, film tricks, go viral, and get away from the problems at home. It’s dangerous. It’s stupid. It’s got parent groups in a panic. And it’s the coolest thing ever.This is Slugblaster. A table-top rpg about teenagehood, giant bugs, circuit-bent rayguns, and trying to be cool.
*** Draw Steel
{{{imgzoom}}}
file:/blog/images/draw-steel.jpg
Heroic, Cinematic, Tactical. High fantasy action with complex and interesting classes. 

The most "gamey" of all the suggestions. Will require tracking numbers, working together, planning your combat actions carefully. Do you have enough squares to move close to the zombie hulk? Can someone else throw you?  
*** Vaults of Vaarn
{{{imgzoom}}}
file:/blog/images/vaarn.webp

Explore a blue desert under the dying red sun. Lots of cool random tables and crazy exotica to find. Dungeon delving on arrakis.
** DONE On Gradient Descent :@rpg:@mothership:
CLOSED: [2025-02-04 Tue 22:12]
:PROPERTIES:
:EXPORT_FILE_NAME: gradient_descent
:END:
Here are some of my thoughts on the mothership Megadungeon [[https://www.tuesdayknightgames.com/products/gradient-descent][Gradient Descent]] as my players have just reached the end of the sixth session.
*** I get Megadungeons
Starting running RPGs with D&D 5th edition put me into a bit of a weird space. I read a lot of the critique online and just didn't understand the problems until I ran a campaign. My players spent hours creating their characters, picking out abilities and writing in some cases some really cool backstories; which immediately meant nothing. I had a story to force them down and I just kept feeling like I wasn't a good enough DM to squish together their complex creations into the pages of the book and craft something greater.

Jesus could I not have been more wrong. Yeah I suck as a DM, but 5th edition (especially their pre-written adventures) does not help you with this at all. The idea of writing characters into an existing story as you are improvising and trying to juggle what "must happen" is so difficult that I would love to see someone pull it off so I can learn from them.

Jumping into Gradient Descent felt overwhelming at first. How do I keep track of all the rooms? How the hell do you roleplay an AI that is beyond human intelligence? Will the players actually enjoy this kinda empty space station? It just works though. The structure of the megadungeon means that story develops as we play and really I barely do any prep at all between sessions and just see what my players do at the table.

The brilliant [[https://dungeons.hismajestytheworm.games/][Designing Dungeons Course]] talks about designing dungeons as an exercising in building up narrative potential energy and man does that hold up for Gradient Descent. It's full to the brim of killer robots, traps and social dilemmas that meant I had to figure out how to put all the pieces together in my head but after that it's just a case of seeing which pieces my players pick up each session.

I have been running this as a open table and it's also been brilliant to get new people sat down and rolling dice with very little fuss about anything that have missed. I think it helps that it's a single big location but also everyone knows that AI is going to destroy the human race so it's easy to get your head straight into it.
*** What are the robots in tubes?
That isn't to say it has always been easy. Gradient descent has the osr feel of sparse descriptions. Which makes it a breeze to run sure but I also found myself breezing over things that maybe would have made the game better?

A particular scene that stood out were some androids in stasis in a room the player's travelled through. It's not really clear why they are there? I guessed as a security counter measure but what sets them off? Are they just triggered by too much movement? Is this a puzzle? In my panic they stayed off as the players went through but later on they tripped an alarm so they dropped out the ceiling. But the book specifically describes security being sent from another floor.

This could just all be me getting this confused or making it more complicated than it needs to be. But I felt like I didn't get the purpose. Which to be fair to book it gets bang on in some floors where it really clearly says "these guys are religious fundamentalists, they worship monarch" which really was about that many words but it helped me to feel like I knew what the direction was.
*** I'm too nice
The main issues for sure though are me! I really need to be more brutal, especially earlier on in the campaign. I think setting the scene of "you will die here" would have helped to get the players into the osr mindset from the start. So:
- Play the rules as written (I messed up a few rules here and there that gave the players more of a chance).
- Don't be afraid of dragging the fights out
  There were so many cool three way battles going on at points and I often let the players slip away in the melee.
- Make the ending tough.
  Right now they are onto the home stretch trying to take out monarch. It makes sense that a super powerful AI in command of a space station isn't going to go down easy.

In summary the book is amazing and I'm on the megadungeon hypetrain.
** DONE Writing A Compiler In A Week
CLOSED: [2025-05-15 Thu 10:35]
:PROPERTIES:
:EXPORT_FILE_NAME: beazley_course
:END:
Writing a good compiler in a week is a pretty difficult task. Writing it in Haskell when you don't really know what you are doing is even tougher. But, thanks to the amazing course by [[https://www.dabeaz.com/][David Beazley]] I managed it! The code is [[https://github.com/oliverpauffley/wabbit_compiler][here]].

It was an amazing thing to take part in mainly just for the grind of just sitting down and coding at something for a week and by the end having a working project. Not that I just came up with everything myself. Dave does a great job of splitting up the work into mini projects so the compiler seems to just appear as you knock down the tasks. I also heavily borrowed the parsing/lexing sections from [[https://github.com/cronokirby/haskell-in-haskell][cronokirby]] which made that section significantly easier.

Out of all the code I think the section I'm most proud of is this:
#+begin_src haskell
convertInstructions :: B.INSTRUCTION -> LLVMConverter (Maybe LLVMOperation)
convertInstructions (B.PUSH i) = push (InputI i) >> return Nothing
convertInstructions B.ADD = convertBin B.ADD
convertInstructions B.MUL = convertBin B.MUL
convertInstructions B.LT = convertBin B.LT
convertInstructions B.EQ = convertBin B.EQ
convertInstructions (B.LOADGLOBAL n) = convertLoad n Global
convertInstructions (B.LOADLOCAL n) = convertLoad n Local
convertInstructions (B.STOREGLOBAL n) = convertStore n Global
convertInstructions (B.STORELOCAL n) = convertStore n Local
convertInstructions (B.CALL name numArgs) = do
  args <- replicateM numArgs pop
  register <- getRegister
  push (InputR register)
  return $ Just (Call register name args)
convertInstructions B.PRINT = do
  val <- pop
  return $ Just (Print val)
convertInstructions B.RETURN = do
  val <- pop
  return $ Just (Return val)
convertInstructions (B.LOCAL n) = return $ Just (Allocate n)
convertInstructions (B.GOTO bl) = return $ Just (Goto bl)
convertInstructions (B.CBRANCH blT blF) = do
  r <- toIResult <$> pop
  return $ Just (Branch r blT blF)
convertBin :: B.INSTRUCTION -> LLVMConverter (Maybe LLVMOperation)
convertBin op = do
  right <- pop
  left <- pop
  register <- getRegister
  push (InputR register)
  return $ Just (BinOp (convertBinOp op) register left right)
#+end_src

What does it do? Well the =LLVMConvertor= is a state monad. It is responsible for two things.
1. Tracking the current register we are going to use for some LLVM instructions.
2. Keeping a stack of "interpreter" code that we need to covert into LLVM instructions.

We have already done some preliminary transformations to make this easier. So we should be starting from something like
#+begin_src
PUSH 10
STOREGLOBAL "x"
LOADGLOBAL "x"
PUSH 1
ADD
STOREGLOBAL "x"
PUSH 23
PUSH 45
MUL
LOADGLOBAL "x"
ADD
PRINT
#+end_src

Which we need to transform into
#+begin_src
    store i32 10, i32* @x
    %.0 = load i32, i32* @x
    %.1 = add i32 %.0, 1
    store i32 %.1, i32* @x
    %.2 = mul i32 23, 45
    %.3 = load i32, i32* @x
    %.4 = add i32 %.2, %.3
    call i32 (i32) @_print_int(i32 %.4)
    ret i32 0
#+end_src

The key parts here are the register names =%.0= and that we have turned something like
#+begin_src
PUSH 23
PUSH 45
MUL
#+end_src
into
#+begin_src
%.2 = mul i32 23, 45
#+end_src

So how does the haskell work?
#+begin_src haskell
convertInstructions :: B.INSTRUCTION -> LLVMConverter (Maybe LLVMOperation)
#+end_src
Within the monad we are given an =INSTRUCTION= like "PUSH 10"
Well this needs to go into our stack within the state monad. So we just =push= onto the stack but we don't need to return a LLVM operation so the code for converting an interpreter instruction into an LLVM operation is:
#+begin_src haskell
convertInstructions :: B.INSTRUCTION -> LLVMConverter (Maybe LLVMOperation)
convertInstructions (B.PUSH i) = push (InputI i) >> return Nothing
#+end_src
Or push the number onto our stack of instructions and return nothing

Then when we get to a =MUL= instruction we already have the two numbers on our stack of instructions so we need to "pop" those off, get a new register to assign our result to and then return the operation. Getting a new register looks like this:
#+begin_src haskell
-- | gets a new register to store values and increments the counter for the next call
getRegister :: LLVMConverter IResult
getRegister = do
  LLVMState {..} <- get
  put $ LLVMState (succ _registerValue) _stack
  return _registerValue
#+end_src
So we get the current state of our register value, get it's successor with =succ= and update the value in the state. And converting an binary operation is just
#+begin_src haskell
convertBin :: B.INSTRUCTION -> LLVMConverter (Maybe LLVMOperation)
convertBin op = do
  right <- pop
  left <- pop
  register <- getRegister
  push (InputR register)
  return $ Just (BinOp (convertBinOp op) register left right)
#+end_src
Note that we need to keep track of the registers in the stack which is what the line =push (InputR register)= is doing.

I still have lots of do on this compiler and I learnt so much during the course that I would really like to just start again with the knowledge that I have now. Overall I highly recommend taking one of David's courses.
